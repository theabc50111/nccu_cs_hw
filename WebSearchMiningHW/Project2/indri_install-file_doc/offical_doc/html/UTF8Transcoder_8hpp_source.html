<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Indri: UTF8Transcoder.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e66345dc6d1b86d5ae575ef167b2f0e3.html">dfisher</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_bea7fe193197db75935da8b819262029.html">work1</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_dc42d2abfa4957ea59e562d7b055053d.html">indri</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4eb84ac341285b465804c24c7ab136d3.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_2a13c2a5b681f3a69ef019f5e983f3bf.html">indri</a>
  </div>
</div>
<div class="contents">
<h1>UTF8Transcoder.hpp</h1><a href="UTF8Transcoder_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*==========================================================================</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2004 University of Massachusetts.  All Rights Reserved.</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Use of the Lemur Toolkit for Language Modeling and Information Retrieval</span>
<a name="l00005"></a>00005 <span class="comment"> * is subject to the terms of the software license set forth in the LICENSE</span>
<a name="l00006"></a>00006 <span class="comment"> * file included with this software, and also available at</span>
<a name="l00007"></a>00007 <span class="comment"> * http://www.lemurproject.org/license.html</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *==========================================================================</span>
<a name="l00010"></a>00010 <span class="comment"> */</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">// UTF8Transcoder</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// 15 September 2005 -- mwb</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">// Simple class that converts Unicode characters to and from UTF-8</span>
<a name="l00020"></a>00020 <span class="comment">// encoding.  This class is used by the TextTokenizer for interpreting</span>
<a name="l00021"></a>00021 <span class="comment">// strings identified as possibly being in UTF-8 encoding, and by the</span>
<a name="l00022"></a>00022 <span class="comment">// UTF8CaseNormalizationTransformation.</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#ifndef INDRI_UTF8TRANSCODER_HPP</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#define INDRI_UTF8TRANSCODER_HPP</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="indri-platform_8h.html">indri/indri-platform.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="HashTable_8hpp.html">indri/HashTable.hpp</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">namespace </span>indri {
<a name="l00032"></a>00032   <span class="keyword">namespace </span>parse {
<a name="l00033"></a>00033     
<a name="l00034"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html">00034</a>     <span class="keyword">namespace </span>CharClass {
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a14e0008a383e23e0cc4a9c72b004066e">00036</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a14e0008a383e23e0cc4a9c72b004066e">apostrophe</a> = 1;
<a name="l00037"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#ac2effb708661dd7ad45079114a37a2d9">00037</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#ac2effb708661dd7ad45079114a37a2d9">percent</a> = 2;
<a name="l00038"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#aa05192993178774388c0a0c082cf4668">00038</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#aa05192993178774388c0a0c082cf4668">control</a> = 3;
<a name="l00039"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a32e255396d753af45f7891b1b11b87fa">00039</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a32e255396d753af45f7891b1b11b87fa">currency</a> = 4;
<a name="l00040"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a440e2a3dba7c6f16fddb5f00f88b9567">00040</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a440e2a3dba7c6f16fddb5f00f88b9567">symbol</a> = 5;
<a name="l00041"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#afe271d39fd7dd119f468be9abadfb63b">00041</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#afe271d39fd7dd119f468be9abadfb63b">letter</a> = 6;
<a name="l00042"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a3c7e1cf5585a1956ce7d949ad90ff45b">00042</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a3c7e1cf5585a1956ce7d949ad90ff45b">digit</a> = 7;
<a name="l00043"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a84d2628d4067094ab774b239e04f8dba">00043</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a84d2628d4067094ab774b239e04f8dba">punctuation</a> = 8;
<a name="l00044"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a2b57f427b26fa5eee9207a93f730ecb4">00044</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a2b57f427b26fa5eee9207a93f730ecb4">whitespace</a> = 9;
<a name="l00045"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#ae608963e031c243fb8de9cf2256d6590">00045</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#ae608963e031c243fb8de9cf2256d6590">decimal</a> = 10;
<a name="l00046"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a78af5a3dc1d6297dc24cbb9aa08dbc99">00046</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#a78af5a3dc1d6297dc24cbb9aa08dbc99">hyphen</a> = 11;
<a name="l00047"></a><a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#af07dbf6cb59f2a2f813101687e502121">00047</a>       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceindri_1_1parse_1_1CharClass.html#af07dbf6cb59f2a2f813101687e502121">thousand</a> = 12;
<a name="l00048"></a>00048     }
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html">00050</a>     <span class="keyword">class </span><a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html">UTF8Transcoder</a> {
<a name="l00051"></a>00051 
<a name="l00052"></a>00052     <span class="keyword">private</span>:
<a name="l00053"></a>00053 
<a name="l00054"></a>00054       <span class="comment">// This function checks for a sequence of bytes between and</span>
<a name="l00055"></a>00055       <span class="comment">// inclusive of 0x80 and 0xBF and returns how many exist.</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057       <span class="keywordtype">int</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a520998d3a4bca4b8a5fe3393d059583e">_count_bytes</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span> index, <span class="keywordtype">int</span> max_index, <span class="keywordtype">int</span> how_many );
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a51be411c51b5324ed8a2bb6313542cc4">00059</a>       <a class="code" href="classindri_1_1utility_1_1HashTable.html">indri::utility::HashTable&lt;UINT64,const int&gt;</a> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a51be411c51b5324ed8a2bb6313542cc4">u</a>;
<a name="l00060"></a>00060       <span class="keywordtype">void</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#aeea571bd9ff2db0b632f86934d2b1a11">store_interval</a>( <a class="code" href="classindri_1_1utility_1_1HashTable.html">indri::utility::HashTable&lt;UINT64,const int&gt;</a>&amp;
<a name="l00061"></a>00061                                   table, UINT64 start, UINT64 end, 
<a name="l00062"></a>00062                                   <span class="keyword">const</span> <span class="keywordtype">int</span> cls );
<a name="l00063"></a>00063 
<a name="l00064"></a>00064       <span class="keywordtype">void</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#ad841a38a0b69c338b15543d156cab201">_initHT</a>() ;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="keyword">public</span>:
<a name="l00067"></a>00067       <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a0e72f7d6b28b44fbc43ca9b8366b84b0">UTF8Transcoder</a>();
<a name="l00068"></a>00068       <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a3fe5820e1e963b9b54e0a5f5cc91cd27">~UTF8Transcoder</a>();
<a name="l00069"></a>00069 
<a name="l00070"></a>00070       <span class="comment">// This function computes the UTF-8 byte sequence for the</span>
<a name="l00071"></a>00071       <span class="comment">// specified Unicode character code.  The bytes are written into</span>
<a name="l00072"></a>00072       <span class="comment">// the specified buffer, which must be large enough to hold the</span>
<a name="l00073"></a>00073       <span class="comment">// byte sequence (always &lt;= 6 bytes in length) as well as the</span>
<a name="l00074"></a>00074       <span class="comment">// terminating null.  The number of octets, which equals the</span>
<a name="l00075"></a>00075       <span class="comment">// number of bytes written to the buffer not including the</span>
<a name="l00076"></a>00076       <span class="comment">// terminating null, is stored in the octets integer.</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078       <span class="keywordtype">void</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a4a51269baab891b21dd190bcc7b19696">utf8_encode</a>( UINT64 code, <span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span>* octets );
<a name="l00079"></a>00079 
<a name="l00080"></a>00080       <span class="comment">// This function decodes a char[] assumed to be in UTF-8</span>
<a name="l00081"></a>00081       <span class="comment">// encoding.  Results are stored in as unicode codes in the</span>
<a name="l00082"></a>00082       <span class="comment">// supplied UINT64[] array, which must have as many elements as</span>
<a name="l00083"></a>00083       <span class="comment">// the char[] array because in the worst case, it contains an</span>
<a name="l00084"></a>00084       <span class="comment">// ASCII string.  The number of characters decoded is stored in</span>
<a name="l00085"></a>00085       <span class="comment">// the characters integer, and the number of malformed bytes</span>
<a name="l00086"></a>00086       <span class="comment">// skipped is stored in the malformed integer.  Offsets and</span>
<a name="l00087"></a>00087       <span class="comment">// lengths are optional parameters; if not NULL, they will be</span>
<a name="l00088"></a>00088       <span class="comment">// filled with byte offsets where the UTF-8 characters begin and</span>
<a name="l00089"></a>00089       <span class="comment">// lengths of each encoding in bytes as they occurr in the input</span>
<a name="l00090"></a>00090       <span class="comment">// buffer.  Offsets and lengths must have as many elements as</span>
<a name="l00091"></a>00091       <span class="comment">// the input buffer has bytes.</span>
<a name="l00092"></a>00092 
<a name="l00093"></a>00093       <span class="keywordtype">void</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a2d7def4ae3fb3e77888ab47eeff4bff8">utf8_decode</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* buf_in, UINT64** codes, <span class="keywordtype">int</span>* characters,
<a name="l00094"></a>00094                         <span class="keywordtype">int</span>* malformed, <span class="keywordtype">int</span>** offsets, <span class="keywordtype">int</span>** lengths );
<a name="l00095"></a>00095       
<a name="l00096"></a><a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a0b3acd52e815df0ba3a6376ec5829dd3">00096</a>       <a class="code" href="classindri_1_1utility_1_1HashTable.html">indri::utility::HashTable&lt;UINT64,const int&gt;</a>&amp; <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a0b3acd52e815df0ba3a6376ec5829dd3">unicode</a>() {
<a name="l00097"></a>00097         <span class="keywordflow">return</span> <a class="code" href="classindri_1_1parse_1_1UTF8Transcoder.html#a51be411c51b5324ed8a2bb6313542cc4">u</a>;
<a name="l00098"></a>00098       }      
<a name="l00099"></a>00099     };
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   }
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="preprocessor">#endif // INDRI_UTF8TRANSCODER_HPP</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 17 Dec 2014 for Indri by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
